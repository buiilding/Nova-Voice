# ===========================================
# NOVA VOICE - Environment Configuration
# ===========================================
# Copy this file to .env and modify values as needed
# All variables have sensible defaults if not set
#
# For GPU usage: Set DEVICE=cuda (STT) and FORCE_CPU=false (Translation)
# For CPU-only: Set DEVICE=cpu and FORCE_CPU=true

# ===========================================
# SHARED CONFIGURATION (All Services)
# ===========================================

# Redis connection URL for message queuing and state storage
REDIS_URL=redis://redis:6379

# ===========================================
# GATEWAY SERVICE CONFIGURATION
# ===========================================

# WebSocket port for client connections
GATEWAY_PORT=5026

# HTTP health check port for Gateway service
HEALTH_PORT=8080

# Duration of silence (in seconds) before ending speech detection
SILENCE_THRESHOLD_SECONDS=1.0

# Audio sample rate in Hz (16kHz recommended for speech)
SAMPLE_RATE=16000

# WebRTC VAD sensitivity (0-3, higher = more sensitive to speech)
WEBRTC_SENSITIVITY=3

# Silero VAD sensitivity (0.0-1.0, higher = more sensitive to speech)
SILERO_SENSITIVITY=0.7

# Audio buffer duration before speech detection starts (seconds)
PRE_SPEECH_BUFFER_SECONDS=2.0

# Minimum new audio duration required before sending job (seconds)
MINIMUM_NEW_AUDIO_SECONDS=1.0

# Maximum Redis queue depth for backpressure control
MAX_QUEUE_DEPTH=100

# Maximum audio buffer duration before forcing job creation (seconds)
MAX_AUDIO_BUFFER_SECONDS=10.0

# Default source language for speech recognition
DEFAULT_SOURCE_LANGUAGE=en

# Default target language for translation
DEFAULT_TARGET_LANGUAGE=vi

# Session expiration time in seconds (15 minutes default)
SESSION_EXPIRATION_SECONDS=900

# Enable/disable audio enhancement features
ENABLE_AUDIO_ENHANCEMENT=true

# Audio volume boost in dB for louder input
AUDIO_VOLUME_BOOST_DB=7.0

# ===========================================
# STT WORKER CONFIGURATION
# ===========================================

# Redis consumer group name for STT workers
CONSUMER_GROUP=stt_workers

# Redis stream name for publishing transcription results
TRANSCRIPTIONS_STREAM=transcriptions

# Whisper model size (tiny, base, small, medium, large-v3)
MODEL_SIZE=base

# Computing device (cuda/cpu)
DEVICE=cuda

# Beam search size for transcription accuracy (1-5, higher = more accurate but slower)
BEAM_SIZE=1

# Enable/disable VAD filtering in transcription (true/false)
VAD_FILTER=false

# Number of best candidates to generate (1-5)
BEST_OF=1

# Pending acknowledgment TTL in seconds (time to wait for job completion)
PENDING_ACK_TTL=300

# HTTP health check port for STT worker (must be unique from other services)
HEALTH_PORT_STT=8081

# ===========================================
# TRANSLATION WORKER CONFIGURATION
# ===========================================

# NLLB model name for translation (facebook/nllb-200-* variants)
NLLB_MODEL=facebook/nllb-200-distilled-600M

# Force CPU usage even if CUDA is available (true/false)
FORCE_CPU=false

# Maximum sequence length for translation input (in tokens)
MAX_SEQUENCE_LENGTH=512

# Batch size for translation processing (1 for real-time, higher for throughput)
BATCH_SIZE=1

# HTTP health check port for Translation worker (must be unique from other services)
HEALTH_PORT_TRANSLATION=8082

# ===========================================
# NOTES
# ===========================================
# Health check endpoints:
# - Gateway: http://localhost:8080/health
# - STT Worker: http://localhost:8081/health
# - Translation Worker: http://localhost:8082/health
#
# WebSocket endpoint:
# - Gateway: ws://localhost:5026' > .env